# get latest download url
$URL = "https://api.github.com/repos/microsoft/winget-cli/releases/latest"
$URL = (Invoke-WebRequest -Uri $URL).Content | ConvertFrom-Json |
        Select-Object -ExpandProperty "assets" |
        Where-Object "browser_download_url" -Match '.msixbundle' |
        Select-Object -ExpandProperty "browser_download_url"

# download
Invoke-WebRequest -Uri $URL -OutFile "Setup.msix" -UseBasicParsing

# install
Add-AppxPackage -Path "Setup.msix"

# delete file
Remove-Item "Setup.msix"


Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy Unrestricted

winget install Microsoft.PowerToys

winget install 9P1741LKHQS9
winget install  Lexikos.AutoHotkey

winget install --id=Microsoft.Teams -e
winget install --id=Notion.Notion -e
winget install --id=Discord.Discord -e
winget install --id=Valve.Steam -e
winget install --id=AgileBits.1Password.CLI -e
winget install --id=Google.Chrome -e
winget install --id=JanDeDobbeleer.OhMyPosh -e
winget install --id=Microsoft.PowerShell -e 
winget install --id=Hashicorp.Terraform -e
winget install --id=MikeFarah.yq -e
winget install --id=Spotify.Spotify -e
winget install --id=Audacity.Audacity -e
winget install --id=stnkl.EverythingToolbar  -e
winget install --id=Hashicorp.Packer -e
winget install --id=Hashicorp.Terraform -e
winget install --id=voidtools.Everything  -e